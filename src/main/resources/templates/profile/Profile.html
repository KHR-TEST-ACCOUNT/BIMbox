<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- BootStrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
<!-- jQuery UI -->
<link href="path/to/multiselect.css" media="screen" rel="stylesheet" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-multiselect-widget/3.0.1/jquery.multiselect.min.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script type="text/javascript" src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
<!-- JS -->
<meta th:replace="fragments/Scripts :: scripts">
<!-- pure CSS -->
<link rel="stylesheet" th:href="@{/css/layout.css}">
<link rel="stylesheet" th:href="@{/css/component.css}">
<script>
$(function(){
    // プルダウン設定
    $("#search_category_id").multiselect({
        minWidth: 170,
        height: 220,
        selectedList: 1,
    	linkInfo: {
    	  checkAll: {text: '全選択', title: '全選択'},
    	  uncheckAll: {text: '全解除', title: '全解除'}
    	},
        noneSelectedText: "カテゴリ",
        selectedText: "# 個選択"
    });
});
</script>
<!-- 
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-multiselect-widget/3.0.0/jquery.multiselect.js"></script>
 -->
<title>プロフィール編集</title>
</head>
<body>
	<div class="cover"></div>
	<div th:replace="fragments/Sidenav :: sidenav"></div>
	<div class="main">
		<div th:replace="fragments/Header :: header"></div>
		<form th:action="@{/profile/ProfileEdit.do}" autocomplete="off"
			enctype="multipart/form-data" method="post" th:object="${profileEditForm}">
			<div class="container-fluid p-4 position-relative">
				<div class="row g-4">
					<div class="col col-12">
						<h5 class="m-0 pb-2 mb-3 border-bottom">アカウント情報</h5>
						<input type="hidden" th:field="*{userId}">
					</div>
				</div>
				<div class="row gy-2">
					<div class="col col-12 col-md-3">
						<span class="fw-bold">社員番号</span>
					</div>
					<div class="col col-12 col-md-9">
						<span th:text="${targetUser.empNo}"></span>
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">氏名</span>
					</div>
					<div class="col col-12 col-md-4">
						<input type="text" class="form-control form-control-sm"
								th:field="*{name}" placeholder="氏名">
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('name')}" class="text-danger"
							th:errors="*{name}"></span>
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">所属部署</span>
					</div>
					<div class="col col-12 col-md-9">
						<span th:text="${targetUser.deptName}"></span>
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">役職</span>
					</div>
					<div class="col col-12 col-md-9">
						<span th:text="${targetUser.posName}"></span>
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">プロフィール画像</span>
					</div>
					<div class="col col-12 col-md-9">
						<div class="p-1 d-inline-block" id="dragandrophandler">
							<img
								th:src="${targetUser.profileImage.encodedString}"
								alt="" class="profile-photo" id="thumbnail" />
						</div>
					</div>
					<div class="col col-12 col-md-3"></div>
					<div class="col col-12 col-md-9">
						<label for="photo-file" class="btn btn-secondary btn-sm shadow-sm">アップロード</label>
						<input type="file" id="photo-file" class="d-none" accept="image/*"
							th:field="*{uploadFile}" />
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">E-Mail</span>
					</div>
					<div class="col col-12 col-md-9">
						<span th:text="${profileEditForm.email}"></span>
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">パスワード</span>
					</div>
					<div class="col col-12 col-md-4">
						<input type="password" class="form-control form-control-sm"
							placeholder="変更後のパスワード" th:field="*{password}"
							th:classappend="${#fields.hasErrors('password') || #fields.hasErrors('passwordConfirmed') 
												? 'is-invalid bg-light' : ''}" />
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('password')}" class="text-danger"
							th:errors="*{password}"></span>
					</div>
					<div class="col col-12 col-md-3"></div>
					<div class="col col-12 col-md-4">
						<input type="password" class="form-control form-control-sm"
							placeholder="再入力" th:field="*{passwordConfirm}"
							th:classappend="${#fields.hasErrors('passwordConfirm') || 
												#fields.hasErrors('passwordConfirmed') ? 'is-invalid bg-light' : ''}" />
					</div>
					<div class="col col-12 col-md-4">
						<div th:if="${#fields.hasErrors('passwordConfirm')}">
							<span class="text-danger" th:errors="*{passwordConfirm}"></span>
						</div>
						<div th:if="${#fields.hasErrors('passwordConfirmed')}">
							<span class="text-danger" th:errors="*{passwordConfirmed}"></span>
						</div>
					</div>
				</div>
				<!-- 個人情報 -->
				<div class="row g-3">
					<div class="col col-12">
						<h5 class="m-0 pb-2 my-3 border-bottom">個人情報</h5>
					</div>
				</div>
				<div class="row gy-2 mb-4">
					<div class="col col-12 col-md-3">
						<span class="fw-bold">趣味登録</span>
					</div>
					<div class="col col-12 col-md-8">
					
					    <select th:field="*{hobbys}" id='search_category_id' name='search[category_id][]' multiple="multiple">
							<option value="プログラミング">プログラミング</option>
							<option value="アウトドア">アウトドア</option>
							<option value="ファッション">ファッション</option>
							<option value="筋トレ">筋トレ</option>
							<option value="映画">映画</option>
							<option value="漫画・アニメ">漫画・アニメ</option>
							<option value="ペット">ペット</option>
					    </select>
					    
					    <!-- 
						<select id='search_category_id' name='search[category_id][]' multiple="multiple">
						    <option value='1' >企業</option>
						    <option value='2' >個人</option>
						    <option value='3' >学校</option>
						    <option value='4' >施設</option>
						    <option value='5' >商社</option>
						    <option value='6' >倉庫</option>
						    <option value='7' >その他</option>
						</select>		
						
						jQuery → jQuery UI → Bootstrap の順に読み込ませる必要あり。
						Bootstrapのツールチップが使えなくなる。
					     -->
					</div>
					
					<div class="col col-12 col-md-3">
						<span class="fw-bold">自己紹介</span>
					</div>
					<div class="col col-12 col-md-4">
						<input type="text" class="form-control form-control-sm"
							th:field="*{aboutMe}" placeholder="自分自身についての簡単な紹介（256文字以内）"
							th:classappend="${#fields.hasErrors('aboutMe') ? 'is-invalid bg-light' : ''}" />
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('aboutMe')}" class="text-danger"
							th:errors="*{aboutMe}"></span>
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">郵便番号</span>
					</div>
					<div class="col col-12 col-md-4 d-flex">
						<input id="zipcode" type="text"
							class="form-control form-control-sm" th:field="*{zipcode}"
							style="width: 7rem;" placeholder="ハイフンなし"
							th:classappend="${#fields.hasErrors('zipcode') ? 'is-invalid bg-light' : ''}" />
						<button type="button" id="search-address"
							class="btn btn-secondary btn-sm shadow-sm ms-2">住所検索</button>
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('zipcode')}" class="text-danger"
							th:errors="*{zipcode}"></span>
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">住所</span>
					</div>
					<div class="col col-12 col-md-4">
						<input id="pref" type="text" class="form-control form-control-sm"
							th:field="*{pref}" placeholder="都道府県" style="width: 10rem;"
							th:classappend="${#fields.hasErrors('pref') ? 'is-invalid bg-light' : ''}" />
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('pref')}" class="text-danger"
							th:errors="*{pref}"></span>
					</div>
					<div class="col col-12 col-md-3"></div>
					<div class="col col-12 col-md-4">
						<input id="city" type="text" class="form-control form-control-sm"
							th:field="*{city}" placeholder="市区町村"
							th:classappend="${#fields.hasErrors('city') ? 'is-invalid bg-light' : ''}" />
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('city')}" class="text-danger"
							th:errors="*{city}"></span>
					</div>
					<div class="col col-12 col-md-3"></div>
					<div class="col col-12 col-md-4">
						<input type="text" class="form-control form-control-sm"
							th:field="*{bldg}" placeholder="番地・建物"
							th:classappend="${#fields.hasErrors('bldg') ? 'is-invalid bg-light' : ''}" />
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('bldg')}" class="text-danger"
							th:errors="*{bldg}"></span>
					</div>
					<div class="col col-12 col-md-3">
						<span class="fw-bold">電話番号</span>
					</div>
					<div class="col col-12 col-md-4">
						<input type="tel" class="form-control form-control-sm"
							th:field="*{phoneNo}" placeholder="自宅"
							th:classappend="${#fields.hasErrors('phoneNo') ? 'is-invalid bg-light' : ''}" />
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('phoneNo')}" class="text-danger"
							th:errors="*{phoneNo}"></span>
					</div>
					<div class="col col-12 col-md-3"></div>
					<div class="col col-12 col-md-4">
						<input type="tel" class="form-control form-control-sm"
							th:field="*{mobilePhoneNo}" placeholder="携帯"
							th:classappend="${#fields.hasErrors('mobilePhoneNo') ? 'is-invalid bg-light' : ''}" />
					</div>
					<div class="col col-12 col-md-4">
						<span th:if="${#fields.hasErrors('mobilePhoneNo')}"
							class="text-danger" th:errors="*{mobilePhoneNo}"></span>
					</div>
				</div>
				<div class="footer px-3">
					<button class="btn btn-success btn-sm shadow-sm">プロフィールを変更</button>
				</div>
 			</div>
		</form>
	</div>
	<div th:replace="fragments/Toast :: toast"></div>
</body>
</html>